<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StaticPointers #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Distributed.Fork.Internal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">Control.Concurrent</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/stm-2.5.0.0/src"><span class="hs-identifier">Control.Concurrent.STM</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier">Control.Distributed.Closure</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/exceptions-0.10.4/src"><span class="hs-identifier">Control.Monad.Catch</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2kagg0aa7i0njmsmrpsvgsmg3faxjbxy-unliftio-core-0.1.2.0-doc/share/doc/unliftio-core-0.1.2.0/html/src"><span class="hs-identifier">Control.Monad.IO.Unlift</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">Control.Monad.Trans.Reader</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier">Data.Binary</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Binary.Zlib.html"><span class="hs-identifier">Data.Binary.Zlib</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">Data.Void</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">System.Environment</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">System.Exit</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">System.IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier">stdin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- We switch to executor mode only when  @argv[1] == argExecutorMode@.</span><span>
</span><span id="line-33"></span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#argExecutorMode"><span class="hs-identifier hs-type">argExecutorMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-34"></span><span id="argExecutorMode"><span class="annot"><span class="annottext">argExecutorMode :: String
</span><a href="Control.Distributed.Fork.Internal.html#argExecutorMode"><span class="hs-identifier hs-var hs-var">argExecutorMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DISTRIBUTED_FORK_EXECUTOR_MODE&quot;</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- On distributed-fork, we run the same binary both in your machine (called</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- &quot;driver&quot;) and in the remote environment (called &quot;executor&quot;). In order for the</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- program to act according to where it is, you should call this function as the</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- first thing in your @main@:</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- main = do</span><span>
</span><span id="line-44"></span><span class="hs-comment">--   initDistributedFork</span><span>
</span><span id="line-45"></span><span class="hs-comment">--   ...</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#initDistributedFork"><span class="hs-identifier hs-type">initDistributedFork</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="initDistributedFork"><span class="annot"><span class="annottext">initDistributedFork :: IO ()
</span><a href="Control.Distributed.Fork.Internal.html#initDistributedFork"><span class="hs-identifier hs-var hs-var">initDistributedFork</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">IO [String]
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">getArgs</span></a></span><span> </span><span class="annot"><span class="annottext">IO [String] -&gt; ([String] -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679160588"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679160588"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679160588"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Control.Distributed.Fork.Internal.html#argExecutorMode"><span class="hs-identifier hs-var">argExecutorMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Void -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f Void -&gt; f a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">vacuous</span></a></span><span> </span><span class="annot"><span class="annottext">IO Void
</span><a href="Control.Distributed.Fork.Internal.html#runExecutor"><span class="hs-identifier hs-var">runExecutor</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- When on executor mode, we expect a serialised ExecutorClosure from `stdin`,</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- run it and exit.</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#runExecutor"><span class="hs-identifier hs-type">runExecutor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span>
</span><span id="line-58"></span><span id="runExecutor"><span class="annot"><span class="annottext">runExecutor :: IO Void
</span><a href="Control.Distributed.Fork.Internal.html#runExecutor"><span class="hs-identifier hs-var hs-var">runExecutor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ByteString
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-var">BL.hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">stdin</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (IO ()) -&gt; IO ()
forall a. Closure a -&gt; a
</span><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-var">unclosure</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">(Closure (IO ()) -&gt; IO ())
-&gt; (ByteString -&gt; Closure (IO ())) -&gt; ByteString -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ZlibWrapper (Closure (IO ())) -&gt; Closure (IO ())
forall a. ZlibWrapper a -&gt; a
</span><a href="Data.Binary.Zlib.html#unZlibWrapper"><span class="hs-identifier hs-var hs-var">unZlibWrapper</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">(ZlibWrapper (Closure (IO ())) -&gt; Closure (IO ()))
-&gt; (ByteString -&gt; ZlibWrapper (Closure (IO ())))
-&gt; ByteString
-&gt; Closure (IO ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Binary (ZlibWrapper (Closure (IO ()))) =&gt;
ByteString -&gt; ZlibWrapper (Closure (IO ()))
forall a. Binary a =&gt; ByteString -&gt; a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorClosure"><span class="hs-identifier hs-type">ExecutorClosure</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO Void -&gt; IO Void
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO Void
forall a. IO a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- An ExecutorClosure is a serialisable IO action.</span><span>
</span><span id="line-67"></span><span class="hs-keyword">type</span><span> </span><span id="ExecutorClosure"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorClosure"><span class="hs-identifier hs-var">ExecutorClosure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Binary.Zlib.html#ZlibWrapper"><span class="hs-identifier hs-type">ZlibWrapper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- 'Backend' is responsible for running your functions in a remote environment.</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- See:</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">--   * 'Control.Distributed.Fork.Local.localProcessBackend'</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">--   * &lt;http://hackage.haskell.org/package/distributed-dataset-aws distributed-dataset-aws&gt;</span><span>
</span><span id="line-77"></span><span class="hs-keyword">newtype</span><span> </span><span id="Backend"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Backend"><span class="hs-identifier hs-var">Backend</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Backend"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Backend"><span class="hs-identifier hs-var">Backend</span></a></span></span><span>
</span><span id="line-79"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="bExecute"><span class="annot"><span class="annottext">Backend -&gt; ByteString -&gt; BackendM ByteString
</span><a href="Control.Distributed.Fork.Internal.html#bExecute"><span class="hs-identifier hs-var hs-var">bExecute</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#BackendM"><span class="hs-identifier hs-type">BackendM</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- ^ Should run the current binary in the target environment, put the given</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- string as standard input and return the executables answer on the standard</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- output.</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- BackendM is essentially `IO`, but also has the ability to report the status of the</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- executor.</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">newtype</span><span> </span><span id="BackendM"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#BackendM"><span class="hs-identifier hs-var">BackendM</span></a></span></span><span> </span><span id="local-6989586621679160576"><span class="annot"><a href="#local-6989586621679160576"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BackendM"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#BackendM"><span class="hs-identifier hs-var">BackendM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorPendingStatus"><span class="hs-identifier hs-type">ExecutorPendingStatus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679160571"><span id="local-6989586621679160573"><span class="annot"><span class="annottext">a -&gt; BackendM b -&gt; BackendM a
(a -&gt; b) -&gt; BackendM a -&gt; BackendM b
(forall a b. (a -&gt; b) -&gt; BackendM a -&gt; BackendM b)
-&gt; (forall a b. a -&gt; BackendM b -&gt; BackendM a) -&gt; Functor BackendM
forall a b. a -&gt; BackendM b -&gt; BackendM a
forall a b. (a -&gt; b) -&gt; BackendM a -&gt; BackendM b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; BackendM b -&gt; BackendM a
$c&lt;$ :: forall a b. a -&gt; BackendM b -&gt; BackendM a
fmap :: (a -&gt; b) -&gt; BackendM a -&gt; BackendM b
$cfmap :: forall a b. (a -&gt; b) -&gt; BackendM a -&gt; BackendM b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>      </span><span id="local-6989586621679160559"><span id="local-6989586621679160561"><span id="local-6989586621679160563"><span id="local-6989586621679160565"><span id="local-6989586621679160567"><span class="annot"><span class="annottext">Functor BackendM
a -&gt; BackendM a
Functor BackendM
-&gt; (forall a. a -&gt; BackendM a)
-&gt; (forall a b. BackendM (a -&gt; b) -&gt; BackendM a -&gt; BackendM b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; BackendM a -&gt; BackendM b -&gt; BackendM c)
-&gt; (forall a b. BackendM a -&gt; BackendM b -&gt; BackendM b)
-&gt; (forall a b. BackendM a -&gt; BackendM b -&gt; BackendM a)
-&gt; Applicative BackendM
BackendM a -&gt; BackendM b -&gt; BackendM b
BackendM a -&gt; BackendM b -&gt; BackendM a
BackendM (a -&gt; b) -&gt; BackendM a -&gt; BackendM b
(a -&gt; b -&gt; c) -&gt; BackendM a -&gt; BackendM b -&gt; BackendM c
forall a. a -&gt; BackendM a
forall a b. BackendM a -&gt; BackendM b -&gt; BackendM a
forall a b. BackendM a -&gt; BackendM b -&gt; BackendM b
forall a b. BackendM (a -&gt; b) -&gt; BackendM a -&gt; BackendM b
forall a b c.
(a -&gt; b -&gt; c) -&gt; BackendM a -&gt; BackendM b -&gt; BackendM c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: BackendM a -&gt; BackendM b -&gt; BackendM a
$c&lt;* :: forall a b. BackendM a -&gt; BackendM b -&gt; BackendM a
*&gt; :: BackendM a -&gt; BackendM b -&gt; BackendM b
$c*&gt; :: forall a b. BackendM a -&gt; BackendM b -&gt; BackendM b
liftA2 :: (a -&gt; b -&gt; c) -&gt; BackendM a -&gt; BackendM b -&gt; BackendM c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; BackendM a -&gt; BackendM b -&gt; BackendM c
&lt;*&gt; :: BackendM (a -&gt; b) -&gt; BackendM a -&gt; BackendM b
$c&lt;*&gt; :: forall a b. BackendM (a -&gt; b) -&gt; BackendM a -&gt; BackendM b
pure :: a -&gt; BackendM a
$cpure :: forall a. a -&gt; BackendM a
$cp1Applicative :: Functor BackendM
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>      </span><span id="local-6989586621679160551"><span id="local-6989586621679160553"><span id="local-6989586621679160555"><span class="annot"><span class="annottext">Applicative BackendM
a -&gt; BackendM a
Applicative BackendM
-&gt; (forall a b. BackendM a -&gt; (a -&gt; BackendM b) -&gt; BackendM b)
-&gt; (forall a b. BackendM a -&gt; BackendM b -&gt; BackendM b)
-&gt; (forall a. a -&gt; BackendM a)
-&gt; Monad BackendM
BackendM a -&gt; (a -&gt; BackendM b) -&gt; BackendM b
BackendM a -&gt; BackendM b -&gt; BackendM b
forall a. a -&gt; BackendM a
forall a b. BackendM a -&gt; BackendM b -&gt; BackendM b
forall a b. BackendM a -&gt; (a -&gt; BackendM b) -&gt; BackendM b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; BackendM a
$creturn :: forall a. a -&gt; BackendM a
&gt;&gt; :: BackendM a -&gt; BackendM b -&gt; BackendM b
$c&gt;&gt; :: forall a b. BackendM a -&gt; BackendM b -&gt; BackendM b
&gt;&gt;= :: BackendM a -&gt; (a -&gt; BackendM b) -&gt; BackendM b
$c&gt;&gt;= :: forall a b. BackendM a -&gt; (a -&gt; BackendM b) -&gt; BackendM b
$cp1Monad :: Applicative BackendM
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621679160547"><span class="annot"><span class="annottext">Monad BackendM
Monad BackendM
-&gt; (forall a. IO a -&gt; BackendM a) -&gt; MonadIO BackendM
IO a -&gt; BackendM a
forall a. IO a -&gt; BackendM a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: IO a -&gt; BackendM a
$cliftIO :: forall a. IO a -&gt; BackendM a
$cp1MonadIO :: Monad BackendM
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>      </span><span id="local-6989586621679160543"><span class="annot"><span class="annottext">MonadThrow BackendM
MonadThrow BackendM
-&gt; (forall e a.
    Exception e =&gt;
    BackendM a -&gt; (e -&gt; BackendM a) -&gt; BackendM a)
-&gt; MonadCatch BackendM
BackendM a -&gt; (e -&gt; BackendM a) -&gt; BackendM a
forall e a.
Exception e =&gt;
BackendM a -&gt; (e -&gt; BackendM a) -&gt; BackendM a
forall (m :: * -&gt; *).
MonadThrow m
-&gt; (forall e a. Exception e =&gt; m a -&gt; (e -&gt; m a) -&gt; m a)
-&gt; MonadCatch m
catch :: BackendM a -&gt; (e -&gt; BackendM a) -&gt; BackendM a
$ccatch :: forall e a.
Exception e =&gt;
BackendM a -&gt; (e -&gt; BackendM a) -&gt; BackendM a
$cp1MonadCatch :: MonadThrow BackendM
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/exceptions-0.10.4/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadCatch</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>      </span><span id="local-6989586621679160539"><span class="annot"><span class="annottext">Monad BackendM
e -&gt; BackendM a
Monad BackendM
-&gt; (forall e a. Exception e =&gt; e -&gt; BackendM a)
-&gt; MonadThrow BackendM
forall e a. Exception e =&gt; e -&gt; BackendM a
forall (m :: * -&gt; *).
Monad m -&gt; (forall e a. Exception e =&gt; e -&gt; m a) -&gt; MonadThrow m
throwM :: e -&gt; BackendM a
$cthrowM :: forall e a. Exception e =&gt; e -&gt; BackendM a
$cp1MonadThrow :: Monad BackendM
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/exceptions-0.10.4/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadThrow</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>      </span><span id="local-6989586621679160531"><span id="local-6989586621679160533"><span id="local-6989586621679160535"><span class="annot"><span class="annottext">MonadCatch BackendM
MonadCatch BackendM
-&gt; (forall b.
    ((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b)
-&gt; (forall b.
    ((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b)
-&gt; (forall a b c.
    BackendM a
    -&gt; (a -&gt; ExitCase b -&gt; BackendM c)
    -&gt; (a -&gt; BackendM b)
    -&gt; BackendM (b, c))
-&gt; MonadMask BackendM
BackendM a
-&gt; (a -&gt; ExitCase b -&gt; BackendM c)
-&gt; (a -&gt; BackendM b)
-&gt; BackendM (b, c)
((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b
((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b
forall b.
((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b
forall a b c.
BackendM a
-&gt; (a -&gt; ExitCase b -&gt; BackendM c)
-&gt; (a -&gt; BackendM b)
-&gt; BackendM (b, c)
forall (m :: * -&gt; *).
MonadCatch m
-&gt; (forall b. ((forall a. m a -&gt; m a) -&gt; m b) -&gt; m b)
-&gt; (forall b. ((forall a. m a -&gt; m a) -&gt; m b) -&gt; m b)
-&gt; (forall a b c.
    m a -&gt; (a -&gt; ExitCase b -&gt; m c) -&gt; (a -&gt; m b) -&gt; m (b, c))
-&gt; MonadMask m
generalBracket :: BackendM a
-&gt; (a -&gt; ExitCase b -&gt; BackendM c)
-&gt; (a -&gt; BackendM b)
-&gt; BackendM (b, c)
$cgeneralBracket :: forall a b c.
BackendM a
-&gt; (a -&gt; ExitCase b -&gt; BackendM c)
-&gt; (a -&gt; BackendM b)
-&gt; BackendM (b, c)
uninterruptibleMask :: ((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b
$cuninterruptibleMask :: forall b.
((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b
mask :: ((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b
$cmask :: forall b.
((forall a. BackendM a -&gt; BackendM a) -&gt; BackendM b) -&gt; BackendM b
$cp1MonadMask :: MonadCatch BackendM
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/exceptions-0.10.4/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadMask</span></a></span></span></span></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>      </span><span id="local-6989586621679160525"><span id="local-6989586621679160527"><span class="annot"><span class="annottext">MonadIO BackendM
BackendM (UnliftIO BackendM)
MonadIO BackendM
-&gt; BackendM (UnliftIO BackendM)
-&gt; (forall b.
    ((forall a. BackendM a -&gt; IO a) -&gt; IO b) -&gt; BackendM b)
-&gt; MonadUnliftIO BackendM
((forall a. BackendM a -&gt; IO a) -&gt; IO b) -&gt; BackendM b
forall b. ((forall a. BackendM a -&gt; IO a) -&gt; IO b) -&gt; BackendM b
forall (m :: * -&gt; *).
MonadIO m
-&gt; m (UnliftIO m)
-&gt; (forall b. ((forall a. m a -&gt; IO a) -&gt; IO b) -&gt; m b)
-&gt; MonadUnliftIO m
withRunInIO :: ((forall a. BackendM a -&gt; IO a) -&gt; IO b) -&gt; BackendM b
$cwithRunInIO :: forall b. ((forall a. BackendM a -&gt; IO a) -&gt; IO b) -&gt; BackendM b
askUnliftIO :: BackendM (UnliftIO BackendM)
$caskUnliftIO :: BackendM (UnliftIO BackendM)
$cp1MonadUnliftIO :: MonadIO BackendM
</span><a href="../file:///nix/store/2kagg0aa7i0njmsmrpsvgsmg3faxjbxy-unliftio-core-0.1.2.0-doc/share/doc/unliftio-core-0.1.2.0/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadUnliftIO</span></a></span></span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679160523"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679160517"><span id="local-6989586621679160519"><span id="local-6989586621679160521"><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFinalStatus"><span class="hs-identifier hs-type">ExecutorFinalStatus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160523"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- Given an IO action and a static proof that the result is 'Serializable', this</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- function runs the action using the Backend in a separate thread and returns a</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- 'TVar' holding the 'ExecutorStatus'.</span><span>
</span><span id="line-107"></span><span id="local-6989586621679160515"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#runBackend"><span class="hs-identifier hs-type">runBackend</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/4jpai2h6b0j4n52h6j98s4v8afs01fr1-constraints-0.11.2-doc/share/doc/constraints-0.11.2/html/src"><span class="hs-identifier hs-type">Dict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Serializable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160515"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160515"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160515"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span id="runBackend"><span class="annot"><span class="annottext">runBackend :: Closure (Dict (Serializable i))
-&gt; Closure (IO i) -&gt; Backend -&gt; IO (Handle i)
</span><a href="Control.Distributed.Fork.Internal.html#runBackend"><span class="hs-identifier hs-var hs-var">runBackend</span></a></span></span><span> </span><span id="local-6989586621679160513"><span class="annot"><span class="annottext">Closure (Dict (Serializable i))
</span><a href="#local-6989586621679160513"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span id="local-6989586621679160512"><span class="annot"><span class="annottext">Closure (IO i)
</span><a href="#local-6989586621679160512"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span id="local-6989586621679160511"><span class="annot"><span class="annottext">ByteString -&gt; BackendM ByteString
</span><a href="#local-6989586621679160511"><span class="hs-identifier hs-var">backend</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable i)) -&gt; Dict (Serializable i)
forall a. Closure a -&gt; a
</span><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-var">unclosure</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable i))
</span><a href="#local-6989586621679160513"><span class="hs-identifier hs-var">dict</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">Dict (Serializable i)
</span><a href="../file:///nix/store/4jpai2h6b0j4n52h6j98s4v8afs01fr1-constraints-0.11.2-doc/share/doc/constraints-0.11.2/html/src"><span class="hs-identifier hs-var">Dict</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#BackendM"><span class="hs-identifier hs-type">BackendM</span></a></span><span> </span><span id="local-6989586621679160509"><span class="annot"><span class="annottext">ReaderT (ExecutorPendingStatus -&gt; IO ()) IO ByteString
</span><a href="#local-6989586621679160509"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; BackendM ByteString
</span><a href="#local-6989586621679160511"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; BackendM ByteString)
-&gt; ByteString -&gt; BackendM ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable i)) -&gt; Closure (IO i) -&gt; ByteString
forall a.
Closure (Dict (Serializable a)) -&gt; Closure (IO a) -&gt; ByteString
</span><a href="Control.Distributed.Fork.Internal.html#toBackendStdin"><span class="hs-identifier hs-var">toBackendStdin</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable i))
</span><a href="#local-6989586621679160513"><span class="hs-identifier hs-var">dict</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (IO i)
</span><a href="#local-6989586621679160512"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621679160507"><span class="annot"><span class="annottext">TVar (ExecutorStatus i)
</span><a href="#local-6989586621679160507"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM (TVar (ExecutorStatus i)) -&gt; IO (TVar (ExecutorStatus i))
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExecutorStatus i -&gt; STM (TVar (ExecutorStatus i))
forall a. a -&gt; STM (TVar a)
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">newTVar</span></a></span><span> </span><span class="annot"><span class="annottext">(ExecutorStatus i -&gt; STM (TVar (ExecutorStatus i)))
-&gt; ExecutorStatus i -&gt; STM (TVar (ExecutorStatus i))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorPendingStatus -&gt; ExecutorStatus i
forall a. ExecutorPendingStatus -&gt; ExecutorStatus a
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorPending"><span class="hs-identifier hs-var">ExecutorPending</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; ExecutorPendingStatus
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorWaiting"><span class="hs-identifier hs-var">ExecutorWaiting</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><span class="annottext">ThreadId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">forkIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>          </span><span id="local-6989586621679160501"><span class="annot"><span class="annottext">Either SomeException ByteString
</span><a href="#local-6989586621679160501"><span class="hs-identifier hs-var">answer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; IO (Either SomeException ByteString)
forall (m :: * -&gt; *) e a.
(MonadCatch m, Exception e) =&gt;
m a -&gt; m (Either e a)
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/exceptions-0.10.4/src"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO (Either SomeException ByteString))
-&gt; IO ByteString -&gt; IO (Either SomeException ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT (ExecutorPendingStatus -&gt; IO ()) IO ByteString
-&gt; (ExecutorPendingStatus -&gt; IO ()) -&gt; IO ByteString
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT (ExecutorPendingStatus -&gt; IO ()) IO ByteString
</span><a href="#local-6989586621679160509"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ())
-&gt; (ExecutorPendingStatus -&gt; STM ())
-&gt; ExecutorPendingStatus
-&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus i) -&gt; ExecutorStatus i -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus i)
</span><a href="#local-6989586621679160507"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(ExecutorStatus i -&gt; STM ())
-&gt; (ExecutorPendingStatus -&gt; ExecutorStatus i)
-&gt; ExecutorPendingStatus
-&gt; STM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorPendingStatus -&gt; ExecutorStatus i
forall a. ExecutorPendingStatus -&gt; ExecutorStatus a
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorPending"><span class="hs-identifier hs-var">ExecutorPending</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679160497"><span class="annot"><span class="annottext">r :: ExecutorFinalStatus i
</span><a href="#local-6989586621679160497"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>                </span><span class="annot"><span class="annottext">(SomeException -&gt; ExecutorFinalStatus i)
-&gt; (ByteString -&gt; ExecutorFinalStatus i)
-&gt; Either SomeException ByteString
-&gt; ExecutorFinalStatus i
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">either</span></a></span><span>
</span><span id="line-123"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679160495"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679160495"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>                      </span><span class="annot"><span class="annottext">Text -&gt; ExecutorFinalStatus i
forall a. Text -&gt; ExecutorFinalStatus a
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorFailed"><span class="hs-identifier hs-var">ExecutorFailed</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ExecutorFinalStatus i) -&gt; Text -&gt; ExecutorFinalStatus i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-125"></span><span>                        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Backend threw an exception: &quot;</span></span><span>
</span><span id="line-126"></span><span>                          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679160495"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>                  </span><span class="annot"><span class="annottext">ByteString -&gt; ExecutorFinalStatus i
forall a. Binary a =&gt; ByteString -&gt; ExecutorFinalStatus a
</span><a href="Control.Distributed.Fork.Internal.html#fromBackendStdout"><span class="hs-identifier hs-var">fromBackendStdout</span></a></span><span>
</span><span id="line-129"></span><span>                  </span><span class="annot"><span class="annottext">Either SomeException ByteString
</span><a href="#local-6989586621679160501"><span class="hs-identifier hs-var">answer</span></a></span><span>
</span><span id="line-130"></span><span>          </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus i) -&gt; ExecutorStatus i -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus i)
</span><a href="#local-6989586621679160507"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExecutorFinalStatus i -&gt; ExecutorStatus i
forall a. ExecutorFinalStatus a -&gt; ExecutorStatus a
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorFinished"><span class="hs-identifier hs-var">ExecutorFinished</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorFinalStatus i
</span><a href="#local-6989586621679160497"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>          </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">Handle i -&gt; IO (Handle i)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Handle i -&gt; IO (Handle i)) -&gt; Handle i -&gt; IO (Handle i)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus i) -&gt; Handle i
forall a. TVar (ExecutorStatus a) -&gt; Handle a
</span><a href="Control.Distributed.Fork.Internal.html#Handle"><span class="hs-identifier hs-var">Handle</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus i)
</span><a href="#local-6989586621679160507"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679160653"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#toBackendStdin"><span class="hs-identifier hs-type">toBackendStdin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/4jpai2h6b0j4n52h6j98s4v8afs01fr1-constraints-0.11.2-doc/share/doc/constraints-0.11.2/html/src"><span class="hs-identifier hs-type">Dict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Serializable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Closure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span></span><span>
</span><span id="line-135"></span><span id="toBackendStdin"><span class="annot"><span class="annottext">toBackendStdin :: Closure (Dict (Serializable a)) -&gt; Closure (IO a) -&gt; ByteString
</span><a href="Control.Distributed.Fork.Internal.html#toBackendStdin"><span class="hs-identifier hs-var hs-var">toBackendStdin</span></a></span></span><span> </span><span id="local-6989586621679160488"><span class="annot"><span class="annottext">Closure (Dict (Serializable a))
</span><a href="#local-6989586621679160488"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span id="local-6989586621679160487"><span class="annot"><span class="annottext">Closure (IO a)
</span><a href="#local-6989586621679160487"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable a)) -&gt; Dict (Serializable a)
forall a. Closure a -&gt; a
</span><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-var">unclosure</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable a))
</span><a href="#local-6989586621679160488"><span class="hs-identifier hs-var">dict</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">Dict (Serializable a)
</span><a href="../file:///nix/store/4jpai2h6b0j4n52h6j98s4v8afs01fr1-constraints-0.11.2-doc/share/doc/constraints-0.11.2/html/src"><span class="hs-identifier hs-var">Dict</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Closure (IO ()) -&gt; ByteString) -&gt; Closure (IO ()) -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ZlibWrapper (Closure (IO ())) -&gt; ByteString
forall a. Binary a =&gt; a -&gt; ByteString
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">(ZlibWrapper (Closure (IO ())) -&gt; ByteString)
-&gt; (Closure (IO ()) -&gt; ZlibWrapper (Closure (IO ())))
-&gt; Closure (IO ())
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (IO ()) -&gt; ZlibWrapper (Closure (IO ()))
forall a. a -&gt; ZlibWrapper a
</span><a href="Data.Binary.Zlib.html#ZlibWrapper"><span class="hs-identifier hs-var">ZlibWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">(Closure (IO ()) -&gt; ByteString) -&gt; Closure (IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">static</span><span> </span><span class="annot"><span class="annottext">Dict (Serializable a) -&gt; IO a -&gt; IO ()
forall a. Dict (Serializable a) -&gt; IO a -&gt; IO ()
</span><a href="#local-6989586621679160483"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable a) -&gt; IO a -&gt; IO ())
-&gt; Closure (Dict (Serializable a)) -&gt; Closure (IO a -&gt; IO ())
forall a b.
Typeable a =&gt;
Closure (a -&gt; b) -&gt; Closure a -&gt; Closure b
</span><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-operator hs-var">`cap`</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (Dict (Serializable a))
</span><a href="#local-6989586621679160488"><span class="hs-identifier hs-var">dict</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (IO a -&gt; IO ()) -&gt; Closure (IO a) -&gt; Closure (IO ())
forall a b.
Typeable a =&gt;
Closure (a -&gt; b) -&gt; Closure a -&gt; Closure b
</span><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-operator hs-var">`cap`</span></a></span><span> </span><span class="annot"><span class="annottext">Closure (IO a)
</span><a href="#local-6989586621679160487"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621679160483"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679160622"><span class="annot"><a href="#local-6989586621679160622"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/4jpai2h6b0j4n52h6j98s4v8afs01fr1-constraints-0.11.2-doc/share/doc/constraints-0.11.2/html/src"><span class="hs-identifier hs-type">Dict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/njgyaw2jbdchp0qz873744qkw2fdx1il-distributed-closure-0.4.2.0-doc/share/doc/distributed-closure-0.4.2.0/html/src"><span class="hs-identifier hs-type">Serializable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679160483"><span class="annot"><span class="annottext">run :: Dict (Serializable a) -&gt; IO a -&gt; IO ()
</span><a href="#local-6989586621679160483"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dict (Serializable a)
</span><a href="../file:///nix/store/4jpai2h6b0j4n52h6j98s4v8afs01fr1-constraints-0.11.2-doc/share/doc/constraints-0.11.2/html/src"><span class="hs-identifier hs-var">Dict</span></a></span><span> </span><span id="local-6989586621679160481"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679160481"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679160481"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; (a -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-var">BL.putStr</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; (a -&gt; ByteString) -&gt; a -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorFinalStatus a -&gt; ByteString
forall a. Binary a =&gt; a -&gt; ByteString
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">(ExecutorFinalStatus a -&gt; ByteString)
-&gt; (a -&gt; ExecutorFinalStatus a) -&gt; a -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ExecutorFinalStatus a
forall a. a -&gt; ExecutorFinalStatus a
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorSucceeded"><span class="hs-identifier hs-var">ExecutorSucceeded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; (SomeException -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) e a.
(MonadCatch m, Exception e) =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/exceptions-0.10.4/src"><span class="hs-operator hs-var">`catch`</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679160477"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679160477"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>                    </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-var">BL.putStr</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; (Text -&gt; ByteString) -&gt; Text -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorFinalStatus a -&gt; ByteString
forall a. Binary a =&gt; a -&gt; ByteString
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">(ExecutorFinalStatus a -&gt; ByteString)
-&gt; (Text -&gt; ExecutorFinalStatus a) -&gt; Text -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ExecutorFinalStatus a
forall a. Text -&gt; ExecutorFinalStatus a
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorFailed"><span class="hs-identifier hs-var">ExecutorFailed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679160622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-144"></span><span>                      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Exception from executor: &quot;</span></span><span>
</span><span id="line-145"></span><span>                        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679160477"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679160629"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#fromBackendStdout"><span class="hs-identifier hs-type">fromBackendStdout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160629"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFinalStatus"><span class="hs-identifier hs-type">ExecutorFinalStatus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160629"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-149"></span><span id="fromBackendStdout"><span class="annot"><span class="annottext">fromBackendStdout :: ByteString -&gt; ExecutorFinalStatus a
</span><a href="Control.Distributed.Fork.Internal.html#fromBackendStdout"><span class="hs-identifier hs-var hs-var">fromBackendStdout</span></a></span></span><span> </span><span id="local-6989586621679160476"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679160476"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; Either
     (ByteString, ByteOffset, String)
     (ByteString, ByteOffset, ExecutorFinalStatus a)
forall a.
Binary a =&gt;
ByteString
-&gt; Either
     (ByteString, ByteOffset, String) (ByteString, ByteOffset, a)
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/binary-0.8.8.0/src"><span class="hs-identifier hs-var">decodeOrFail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/bytestring-0.10.10.0/src"><span class="hs-identifier hs-var">BL.fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679160476"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteOffset
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160473"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679160473"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ExecutorFinalStatus a
forall a. Text -&gt; ExecutorFinalStatus a
</span><a href="Control.Distributed.Fork.Internal.html#ExecutorFailed"><span class="hs-identifier hs-var">ExecutorFailed</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ExecutorFinalStatus a) -&gt; Text -&gt; ExecutorFinalStatus a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error decoding answer: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679160473"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteOffset
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160472"><span class="annot"><span class="annottext">ExecutorFinalStatus a
</span><a href="#local-6989586621679160472"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExecutorFinalStatus a
</span><a href="#local-6989586621679160472"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-keyword">data</span><span> </span><span id="ExecutorStatus"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorStatus"><span class="hs-identifier hs-var">ExecutorStatus</span></a></span></span><span> </span><span id="local-6989586621679160647"><span class="annot"><a href="#local-6989586621679160647"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ExecutorPending"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorPending"><span class="hs-identifier hs-var">ExecutorPending</span></a></span></span><span> </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorPendingStatus"><span class="hs-identifier hs-type">ExecutorPendingStatus</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExecutorFinished"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFinished"><span class="hs-identifier hs-var">ExecutorFinished</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFinalStatus"><span class="hs-identifier hs-type">ExecutorFinalStatus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160647"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160468"><span id="local-6989586621679160470"><span class="annot"><span class="annottext">ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool
(ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool)
-&gt; (ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool)
-&gt; Eq (ExecutorStatus a)
forall a. Eq a =&gt; ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool
$c/= :: forall a. Eq a =&gt; ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool
== :: ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool
$c== :: forall a. Eq a =&gt; ExecutorStatus a -&gt; ExecutorStatus a -&gt; Bool
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160463"><span id="local-6989586621679160465"><span class="annot"><span class="annottext">a -&gt; ExecutorStatus b -&gt; ExecutorStatus a
(a -&gt; b) -&gt; ExecutorStatus a -&gt; ExecutorStatus b
(forall a b. (a -&gt; b) -&gt; ExecutorStatus a -&gt; ExecutorStatus b)
-&gt; (forall a b. a -&gt; ExecutorStatus b -&gt; ExecutorStatus a)
-&gt; Functor ExecutorStatus
forall a b. a -&gt; ExecutorStatus b -&gt; ExecutorStatus a
forall a b. (a -&gt; b) -&gt; ExecutorStatus a -&gt; ExecutorStatus b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; ExecutorStatus b -&gt; ExecutorStatus a
$c&lt;$ :: forall a b. a -&gt; ExecutorStatus b -&gt; ExecutorStatus a
fmap :: (a -&gt; b) -&gt; ExecutorStatus a -&gt; ExecutorStatus b
$cfmap :: forall a b. (a -&gt; b) -&gt; ExecutorStatus a -&gt; ExecutorStatus b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="ExecutorPendingStatus"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorPendingStatus"><span class="hs-identifier hs-var">ExecutorPendingStatus</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ExecutorWaiting"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorWaiting"><span class="hs-identifier hs-var">ExecutorWaiting</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExecutorSubmitted"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorSubmitted"><span class="hs-identifier hs-var">ExecutorSubmitted</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExecutorStarted"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorStarted"><span class="hs-identifier hs-var">ExecutorStarted</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160457"><span id="local-6989586621679160459"><span class="annot"><span class="annottext">ExecutorPendingStatus -&gt; ExecutorPendingStatus -&gt; Bool
(ExecutorPendingStatus -&gt; ExecutorPendingStatus -&gt; Bool)
-&gt; (ExecutorPendingStatus -&gt; ExecutorPendingStatus -&gt; Bool)
-&gt; Eq ExecutorPendingStatus
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExecutorPendingStatus -&gt; ExecutorPendingStatus -&gt; Bool
$c/= :: ExecutorPendingStatus -&gt; ExecutorPendingStatus -&gt; Bool
== :: ExecutorPendingStatus -&gt; ExecutorPendingStatus -&gt; Bool
$c== :: ExecutorPendingStatus -&gt; ExecutorPendingStatus -&gt; Bool
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621679160455"><span id="local-6989586621679160456"></span></span><span class="hs-keyword">data</span><span> </span><span id="ExecutorFinalStatus"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFinalStatus"><span class="hs-identifier hs-var">ExecutorFinalStatus</span></a></span></span><span> </span><span id="local-6989586621679160632"><span class="annot"><a href="#local-6989586621679160632"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ExecutorFailed"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFailed"><span class="hs-identifier hs-var">ExecutorFailed</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExecutorSucceeded"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorSucceeded"><span class="hs-identifier hs-var">ExecutorSucceeded</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679160632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160451"><span id="local-6989586621679160453"><span class="annot"><span class="annottext">ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool
(ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool)
-&gt; (ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool)
-&gt; Eq (ExecutorFinalStatus a)
forall a.
Eq a =&gt;
ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool
$c/= :: forall a.
Eq a =&gt;
ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool
== :: ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool
$c== :: forall a.
Eq a =&gt;
ExecutorFinalStatus a -&gt; ExecutorFinalStatus a -&gt; Bool
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. ExecutorFinalStatus a -&gt; Rep (ExecutorFinalStatus a) x)
-&gt; (forall x.
    Rep (ExecutorFinalStatus a) x -&gt; ExecutorFinalStatus a)
-&gt; Generic (ExecutorFinalStatus a)
forall x. Rep (ExecutorFinalStatus a) x -&gt; ExecutorFinalStatus a
forall x. ExecutorFinalStatus a -&gt; Rep (ExecutorFinalStatus a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (ExecutorFinalStatus a) x -&gt; ExecutorFinalStatus a
forall a x. ExecutorFinalStatus a -&gt; Rep (ExecutorFinalStatus a) x
$cto :: forall a x. Rep (ExecutorFinalStatus a) x -&gt; ExecutorFinalStatus a
$cfrom :: forall a x. ExecutorFinalStatus a -&gt; Rep (ExecutorFinalStatus a) x
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160444"><span id="local-6989586621679160446"><span class="annot"><span class="annottext">a -&gt; ExecutorFinalStatus b -&gt; ExecutorFinalStatus a
(a -&gt; b) -&gt; ExecutorFinalStatus a -&gt; ExecutorFinalStatus b
(forall a b.
 (a -&gt; b) -&gt; ExecutorFinalStatus a -&gt; ExecutorFinalStatus b)
-&gt; (forall a b.
    a -&gt; ExecutorFinalStatus b -&gt; ExecutorFinalStatus a)
-&gt; Functor ExecutorFinalStatus
forall a b. a -&gt; ExecutorFinalStatus b -&gt; ExecutorFinalStatus a
forall a b.
(a -&gt; b) -&gt; ExecutorFinalStatus a -&gt; ExecutorFinalStatus b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; ExecutorFinalStatus b -&gt; ExecutorFinalStatus a
$c&lt;$ :: forall a b. a -&gt; ExecutorFinalStatus b -&gt; ExecutorFinalStatus a
fmap :: (a -&gt; b) -&gt; ExecutorFinalStatus a -&gt; ExecutorFinalStatus b
$cfmap :: forall a b.
(a -&gt; b) -&gt; ExecutorFinalStatus a -&gt; ExecutorFinalStatus b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- Result of a 'fork' is an Handle where you can 'await' a result.</span><span>
</span><span id="line-172"></span><span class="hs-keyword">newtype</span><span> </span><span id="Handle"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Handle"><span class="hs-identifier hs-var">Handle</span></a></span></span><span> </span><span id="local-6989586621679160628"><span class="annot"><a href="#local-6989586621679160628"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Handle"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Handle"><span class="hs-identifier hs-var">Handle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorStatus"><span class="hs-identifier hs-type">ExecutorStatus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- Get the current status of given 'Handle'.</span><span>
</span><span id="line-176"></span><span id="local-6989586621679160596"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#pollHandle"><span class="hs-identifier hs-type">pollHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorStatus"><span class="hs-identifier hs-type">ExecutorStatus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-177"></span><span id="pollHandle"><span class="annot"><span class="annottext">pollHandle :: Handle a -&gt; STM (ExecutorStatus a)
</span><a href="Control.Distributed.Fork.Internal.html#pollHandle"><span class="hs-identifier hs-var hs-var">pollHandle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span id="local-6989586621679160442"><span class="annot"><span class="annottext">TVar (ExecutorStatus a)
</span><a href="#local-6989586621679160442"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus a) -&gt; STM (ExecutorStatus a)
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (ExecutorStatus a)
</span><a href="#local-6989586621679160442"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621679160440"><span class="annot"><a href="Control.Distributed.Fork.Internal.html#tryAwait"><span class="hs-identifier hs-type">tryAwait</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/text-1.2.3.2/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-180"></span><span id="tryAwait"><span class="annot"><span class="annottext">tryAwait :: Handle a -&gt; IO (Either Text a)
</span><a href="Control.Distributed.Fork.Internal.html#tryAwait"><span class="hs-identifier hs-var hs-var">tryAwait</span></a></span></span><span> </span><span id="local-6989586621679160438"><span class="annot"><span class="annottext">Handle a
</span><a href="#local-6989586621679160438"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679160437"><span class="annot"><span class="annottext">ExecutorFinalStatus a
</span><a href="#local-6989586621679160437"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">IO (ExecutorFinalStatus a) -&gt; IO (ExecutorFinalStatus a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (ExecutorFinalStatus a) -&gt; IO (ExecutorFinalStatus a))
-&gt; (STM (ExecutorFinalStatus a) -&gt; IO (ExecutorFinalStatus a))
-&gt; STM (ExecutorFinalStatus a)
-&gt; IO (ExecutorFinalStatus a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">STM (ExecutorFinalStatus a) -&gt; IO (ExecutorFinalStatus a)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (ExecutorFinalStatus a) -&gt; IO (ExecutorFinalStatus a))
-&gt; STM (ExecutorFinalStatus a) -&gt; IO (ExecutorFinalStatus a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="annottext">Handle a -&gt; STM (ExecutorStatus a)
forall a. Handle a -&gt; STM (ExecutorStatus a)
</span><a href="Control.Distributed.Fork.Internal.html#pollHandle"><span class="hs-identifier hs-var">pollHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Handle a
</span><a href="#local-6989586621679160438"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">STM (ExecutorStatus a)
-&gt; (ExecutorStatus a -&gt; STM (ExecutorFinalStatus a))
-&gt; STM (ExecutorFinalStatus a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorPending"><span class="hs-identifier hs-type">ExecutorPending</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorPendingStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">STM (ExecutorFinalStatus a)
forall a. STM a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">retry</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFinished"><span class="hs-identifier hs-type">ExecutorFinished</span></a></span><span> </span><span id="local-6989586621679160434"><span class="annot"><span class="annottext">ExecutorFinalStatus a
</span><a href="#local-6989586621679160434"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExecutorFinalStatus a -&gt; STM (ExecutorFinalStatus a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutorFinalStatus a
</span><a href="#local-6989586621679160434"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><span class="annottext">Either Text a -&gt; IO (Either Text a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Text a -&gt; IO (Either Text a))
-&gt; Either Text a -&gt; IO (Either Text a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExecutorFinalStatus a
</span><a href="#local-6989586621679160437"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorFailed"><span class="hs-identifier hs-type">ExecutorFailed</span></a></span><span> </span><span id="local-6989586621679160433"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160433"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text a
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160433"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="Control.Distributed.Fork.Internal.html#ExecutorSucceeded"><span class="hs-identifier hs-type">ExecutorSucceeded</span></a></span><span> </span><span id="local-6989586621679160432"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160432"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either Text a
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/0z7pkxg8ybr9djlmx845qgjc51n6baha-ghc-8.10.1-doc/share/doc/ghc/html/libraries/base-4.14.0.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160432"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-189"></span></pre></body></html>